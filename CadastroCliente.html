<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Página inicial da Agilus. Aprensentando o sistema Agilus CRM">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="stylesheet" href="/assets/css/output.css">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Agilus - Consignado</title>
    <script src="//code-sa1.jivosite.com/widget/WFZtAfr4QY" async></script>
    <!-- Importar jQuery (necessário para a máscara e validações) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Importar biblioteca para máscara de campos -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <style>
        body {
            background-color: #f9f9f9;
            padding: 20px;
        }
        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        fieldset {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        legend {
            color: #480da3;
            font-weight: bold;
            padding: 0 10px;
        }
        .required::after {
            content: '*';
            color: red;
            margin-left: 5px;
        }
        .error {
            border-color: #ff0000;
        }
        button {
            padding: 10px 20px;
            background-color: #480da3;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 8px;
        }
        #logo-container {
            text-align: right;
            margin-bottom: 20px;
        }
        #logo-container img {
            max-width: 200px;
            max-height: 80px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table th, table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
    </style>
</head>
<body class="text-grey">
    <div id="logo-container">
        <img src="/assets/images/logo-agilus.svg" alt="Logo da Empresa">
    </div>
    <h1 class="mb-4 text-4xl font-extrabold text-center text-primary-600">Cadastro AgilusCRM</h1>
    <form id="cadastroForm">
        <fieldset class="p-6">
            <legend>Dados da Empresa</legend>
            <label for="cnpj_cpf" class="block mb-1 text-sm font-medium text-gray-700 required">CNPJ ou CPF (máx. 14 caracteres):</label>
            <input type="text" id="cnpj_cpf" name="cnpj_cpf" required class="input">
            <label for="razao_social" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Razão Social:</label>
            <input type="text" id="razao_social" name="razao_social" class="input">
            <label for="nome_fantasia" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Nome Fantasia:</label>
            <input type="text" id="nome_fantasia" name="nome_fantasia" class="input" required>
        </fieldset>

        <fieldset class="p-6">
            <legend>Endereço</legend>
            <div class="flex flex-row items-end gap-2">
                <div class="grow">
                    <label class="block mb-1 text-sm font-medium text-gray-700 required">CEP:</label>
                    <input type="text" id="cep" name="cep" class="input">
                </div>
                <button type="button" onclick="buscarEndereco()" class="btn-primary">Buscar</button>
            </div>
            <label for="endereco" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Endereço:</label>
            <input type="text" id="endereco" name="endereco" required class="input">
            <label for="numero" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Número:</label>
            <input type="text" id="numero" name="numero" required class="input">
            <label for="complemento" class="block my-2 text-sm font-medium text-gray-700">Complemento:</label>
            <input type="text" id="complemento" name="complemento" class="input">
            <label for="bairro" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Bairro:</label>
            <input type="text" id="bairro" name="bairro" required class="input">
            <label for="cidade" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Cidade:</label>
            <input type="text" id="cidade" name="cidade" required class="input">
            <label for="uf" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">UF:</label>
            <input type="text" id="uf" name="uf" maxlength="2" required class="input">
        </fieldset>

        <fieldset class="p-6">
            <legend>Dados de Contato</legend>
            <label for="nome_contato" class="block mb-1 text-sm font-medium text-gray-700 required">Nome:</label>
            <input type="text" id="nome_contato" name="nome_contato" required class="input">
            <label for="email_cobranca" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">E-mail de Cobrança:</label>
            <input type="email" id="email_cobranca" name="email_cobranca" required class="input">
            <label for="celular_contato" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Celular:</label>
            <input type="tel" id="celular_contato" name="celular_contato" required class="input">
        </fieldset>

        <fieldset class="p-6">
            <legend>Sócios/Responsáveis</legend>
            <div id="sociosContainer">
                <!-- Aqui serão adicionados os campos de sócios dinamicamente -->
            </div>
            <button type="button" onclick="adicionarSocio()" class="my-4 btn-primary">Adicionar Sócio</button>
        </fieldset>

        <fieldset class="p-6">
            <legend>Planos</legend>
            <label for="planos" class="required">Escolha o plano:</label>
            <select id="planos" name="planos" required class="input">
                <option value="3_usuarios">3 Usuários</option>
                <option value="5_usuarios">5 Usuários</option>
                <option value="10_usuarios">10 Usuários</option>
                <option value="15_usuarios">15 Usuários</option>
                <option value="20_usuarios">20 Usuários</option>
                <option value="30_usuarios">30 Usuários</option>
                <option value="40_usuarios">40 Usuários</option>
                <option value="50_usuarios">50 Usuários</option>
                <option value="75_usuarios">75 Usuários</option>
                <option value="100_usuarios">100 Usuários</option>
                <option value="150_usuarios">150 Usuários</option>
                <option value="200_usuarios">200 Usuários</option>
                <option value="300_usuarios">300 Usuários</option>
                <!-- Adicione as demais opções conforme necessário -->
            </select>
            <div>
                <table class="text-sm">
                    <thead class="text-white bg-primary-500">
                        <th>Usuários</th>
                        <th>Mensalidade</th>
                        <th>Armazenamento<sup>2</sup></th>
                        <th>Indicadores<sup>3</sup></th>
                        <th>Relatórios<sup>4</sup></th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>3 usuários</td>
                            <td>R$ 300,00</td>
                            <td>3GB</td>
                            <td>1</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>5 usuários</td>
                            <td>R$ 475,00</td>
                            <td>3GB</td>
                            <td>2</td>
                            <td>2</td>
                        </tr>
                        <tr>
                            <td>10 Usuários</td>
                            <td>R$ 900,00</td>
                            <td>3GB</td>
                            <td>3</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td>15 usuários</td>
                            <td>R$ 1.275,00</td>
                            <td>3GB</td>
                            <td>4</td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>20 usuários</td>
                            <td>R$ 1.600,00</td>
                            <td>5GB</td>
                            <td>5</td>
                            <td>5</td>
                        </tr>
                        <tr>
                            <td>30 usuários</td>
                            <td>R$ 2.250,00</td>
                            <td>5GB</td>
                            <td>6</td>
                            <td>6</td>
                        </tr>
                        <tr>
                            <td>40 usuários</td>
                            <td>R$ 2.800,00</td>
                            <td>5GB</td>
                            <td>7</td>
                            <td>7</td>
                        </tr>
                        <tr>
                            <td>50 usuários</td>
                            <td>R$ 3.250,00</td>
                            <td>5GB</td>
                            <td>10</td>
                            <td>10</td>
                        </tr>
                        <tr>
                            <td>75 usuários</td>
                            <td>R$ 4.500,00</td>
                            <td>5GB</td>
                            <td>15</td>
                            <td>15</td>
                        </tr>
                        <tr>
                            <td>100 usuários</td>
                            <td>R$ 5.500,00</td>
                            <td>10GB</td>
                            <td>20</td>
                            <td>20</td>
                        </tr>
                        <tr>
                            <td>150 usuários</td>
                            <td>R$ 7.500,00</td>
                            <td>15GB</td>
                            <td>30</td>
                            <td>30</td>
                        </tr>
                        <tr>
                            <td>200 usuários</td>
                            <td>R$ 9.000,00</td>
                            <td>20GB</td>
                            <td>50</td>
                            <td>50</td>
                        </tr>
                        <tr>
                            <td>300 usuários<sup>1</sup></td>
                            <td>R$ 12.000,00</td>
                            <td>30GB</td>
                            <td>ilimitado</td>
                            <td>ilimitado</td>
                        </tr>
                    </tbody>
                </table>
                <div class="mt-4 text-xs">
                    <div class="mb-1">1 - Excedente: R$300,00 pacote de 10 usuários</div>
                    <div class="mb-1">2 - Adicional: 5GB -R$20,00</div>
                    <div class="mb-1">3 - Excedente: a partir de R$50,00 por indicador</div>
                    <div class="mb-1">4 - Excedente: a partir de R$50,00 por relatório</div>
                </div>
            </div>
        </fieldset>

        <button type="submit" class="btn-primary">Cadastrar</button>
    </form>

    <script>
        let maskCpfCnpjBehavior = function (val) {
            return val.replace(/\D/g, '').length <= 11 ? '000.000.000-009' : '00.000.000/0000-00'
        },
        maskTelBehavior = function (val) {
            return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009'
        },
        optionsCpfCnpj = {onKeyPress: function(val, e, field, options) {
                field.mask(maskCpfCnpjBehavior.apply({}, arguments), options)
            }
        },
        optionsTel = {onKeyPress: function(val, e, field, options) {
                field.mask(maskTelBehavior.apply({}, arguments), options)
            }
        }
        //adicionar mascara CNPJ/CPF e telefone/celular
        $("#cnpj_cpf").mask(maskCpfCnpjBehavior, optionsCpfCnpj)
        $("#celular_contato").mask(maskTelBehavior, optionsTel)
        $('#celular_socio1').mask(maskTelBehavior, optionsTel)

        //adicionar mascara do CEP
        $('#cep').mask('00000-000')

        // Função para buscar endereço pelo CEP
        function buscarEndereco() {
            const cep = $('#cep').val().replace(/\D/g, '') // Limpar caracteres não numéricos
            if (cep.length !== 8) {
                alert('CEP inválido. Informe um CEP com 8 dígitos.')
                return
            }

            $.getJSON(`https://viacep.com.br/ws/${cep}/json/`, function(data) {
                if (data.erro) {
                    alert('CEP não encontrado.')
                } else {
                    $('#endereco').val(data.logradouro)
                    $('#bairro').val(data.bairro)
                    $('#cidade').val(data.localidade)
                    $('#uf').val(data.uf)
                    $('#numero').focus() // Colocar foco no campo número após preencher o endereço
                }
            });
        }

        // Função para adicionar campos de sócios
        let numSocios = 0
        function adicionarSocio() {
            numSocios++
            const novoSocio = `
                <div id="socio${numSocios}" class="p-4 mt-4 border rounded-lg">
                    <h3>Sócio ${numSocios}</h3>
                    <div class="flex items-center gap-2 mt-4">
                        <div class="grow">
                            <label for="nome_socio${numSocios}" class="block mb-1 text-sm font-medium text-gray-700 required">Nome do Sócio:</label>
                            <input type="text" id="nome_socio${numSocios}" name="nome_socio${numSocios}" class="input" required>
                            <label for="cpf_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">CPF do Sócio:</label>
                            <input type="text" id="cpf_socio${numSocios}" name="cpf_socio${numSocios}" class="input" maxlength="14" required>
                            <label for="data_nascimento_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Data de Nascimento:</label>
                            <input type="text" id="data_nascimento_socio${numSocios}" name="data_nascimento_socio${numSocios}" class="input data required">
                            <label for="celular_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Celular do Sócio:</label>
                            <input type="tel" id="celular_socio${numSocios}" name="celular_socio${numSocios}" class="input" required>
                            <label for="email_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">E-mail do Sócio:</label>
                            <input type="email" id="email_socio${numSocios}" name="email_socio${numSocios}" class="input" required>
                        </div>
                        <button type="button" onclick="removerSocio(${numSocios})" class="p-4 bg-red-500 rounded-full has-tooltip">
                            <span class='p-1 -mt-8 text-red-500 bg-gray-100 rounded shadow-lg tooltip'>Remover sócio</span>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 stroke-white">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                            </svg>
                        </button>
                    </div>
                </div>
            `
            $('#sociosContainer').append(novoSocio)

            // Aplicar máscaras nos campos do novo sócio
            $(`#cpf_socio${numSocios}`).mask('000.000.000-00')
            $(`#data_nascimento_socio${numSocios}`).mask('00/00/0000')
            $(`#celular_socio${numSocios}`).mask(maskTelBehavior, optionsTel)
        }

        // Função para remover campos de sócios
        function removerSocio(num) {
            numSocios--
            $(`#socio${num}`).remove()
        }
        
        $('form').on('submit', event => {
            event.preventDefault()
            const data = Object.fromEntries(new FormData(event.target).entries())
            let dataFormated = ''
            for (let key in data) {
                dataFormated += `${key}: ${data[key]} \n`
            }
            console.log(dataFormated)
            axios({
                method: "POST",
                url: `https://api.mailslurp.com/sendEmail?apiKey=c8aa02a28e886a018f130038b5a9a9681ac07fb5773c09e90966b0dba229380f`,
                data: {
                    senderId: '921bb366-c2c5-427a-aa78-d29064530d0d',
                    to: 'agilus-921bb366-c2c5-427a-aa78-d29064530d0d@mailslurp.net',
                    subject: 'Novo cliente site',
                    body: dataFormated
                }
            }).then(() => {
                console.log('cliente enviado com sucesso')
            }).catch(error => {
                console.error('Cliete não enviado para o Agilus CRM. Erro: ' + error)
            })
        })
    </script>
</body>
</html>
