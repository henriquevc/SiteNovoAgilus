<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Página inicial da Agilus. Aprensentando o sistema Agilus CRM">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="stylesheet" href="/assets/css/build.css">
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Agilus - Consignado</title>
    <script>
      (function(d,t) {
        var BASE_URL="https://chat.agilusservices.com.br";
        var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=BASE_URL+"/packs/js/sdk.js";
        g.defer = true;
        g.async = true;
        s.parentNode.insertBefore(g,s);
        g.onload=function(){
          window.chatwootSDK.run({
            websiteToken: 'opd8uYojvHeVsXigreQWx19z',
            baseUrl: BASE_URL
          })
        }
      })(document,"script");
    </script>
    <!-- Importar jQuery (necessário para a máscara e validações) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Importar biblioteca para máscara de campos -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <!-- Importar biblioteca de validação do formulário -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/additional-methods.min.js"></script>
    <style>
        .required::after {
            content: '*';
            color: red;
            margin-left: 5px;
        }
        .error {
            border-color: #ff0000;
        }
        button {
            padding: 10px 20px;
            background-color: #480da3;
            color: #fff;
            border: none;
            cursor: pointer;
            border-radius: 8px;
        }
        input[type=radio]:checked + label {
            border-color: #480da3;
            border-width: 2px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            color: #480da3;
        }
        #ramo_error:has(+ label:not(:empty)) {
            border: 1px solid red;
            border-radius: 0.5rem;
            padding: 0.5rem;
        }
        label:not(:empty) + #plano_error {
            border: 2px solid red;
            border-radius: 0.5rem;
            padding: 0.5rem;
        }
    </style>
</head>
<body class="p-2 bg-gray-100 sm:p-4 md:p-6 lg:p-8 text-grey">
    <div id="logo-container">
        <img src="/assets/images/logo-agilus.svg" alt="Logo da Empresa" width="200px">
    </div>
    <div class="grid grid-cols-1 gap-4 lg:grid-cols-2 lg:gap-24">
        <div class="flex flex-col items-center max-w-lg mx-auto mt-4 md:max-w-xl lg:mt-32">
            <h1 class="text-6xl font-extrabold text-center lg:text-left text-primary-600">Cadastro AgilusCRM</h1>
            <p class="max-w-md p-2 mt-4 text-lg text-center lg:min-w-full lg:text-left text-slate-700">Bem-vindo à família Agilus!</p>
            <p class="max-w-md p-2 text-lg text-center lg:max-w-xl lg:text-left text-slate-700"> 
                Gostaríamos de agradecer por escolher nossa empresa como sua parceira de negócios. 
                Estamos certos de que as principais dúvidas da área comercial já foram esclarecidas e agora precisamos que 
                você preencha os dados desse formulário para realizarmos a implantação do seu Agilus CRM.
            </p>
            <p class="max-w-md p-2 text-lg text-center lg:max-w-xl lg:text-left text-slate-700">
    	        Você poderá contar com o nosso suporte para solucionar quaisquer dúvidas ou auxiliá-lo no uso da 
                ferramenta através do número (11) 4040-8065, através do chat disponível dentro do sistema, pelo chat em nosso site www.agilus.com.br ou através do atendimento pelo e-mail suporte@agilus.com.br.
            </p>
        </div>
        
        <form class="relative max-w-md mx-auto md:max-w-lg lg:m-0" id="cadastroForm">
            <!-- Dados da Empresa -->
            <fieldset class="p-4 mb-8 bg-white rounded-lg shadow-xl lg:p-8">
                <legend class="px-4 font-bold text-white rounded-full bg-primary-600">Dados da Empresa</legend>
                <label for="cnpj_cpf" class="block mb-1 text-sm font-medium text-gray-700 required">CNPJ ou CPF:</label>
                <input type="text" id="cnpj_cpf" name="cnpj_cpf" required class="input">
                <label for="razao_social" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Razão Social ou Nome:</label>
                <input type="text" id="razao_social" name="razao_social" class="input" required>
                <label for="nome_fantasia" class="block mt-2 mb-1 text-sm font-medium text-gray-700">Nome Fantasia:</label>
                <input type="text" id="nome_fantasia" name="nome_fantasia" class="input">
            </fieldset>

            <!-- Endereço -->
            <fieldset class="p-4 mb-8 bg-white rounded-lg shadow-xl lg:p-8">
                <legend class="px-4 text-lg font-bold text-white rounded-full bg-primary-600">Endereço</legend>
                <div class="flex flex-row items-end gap-2">
                    <div class="grow">
                        <label class="block mb-1 text-sm font-medium text-gray-700 required">CEP:</label>
                        <input type="text" id="cep" name="cep" required class="input">
                    </div>
                    <button type="button" onclick="buscarEndereco()" class="btn-primary">Buscar</button>
                </div>
                <label for="endereco" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Endereço:</label>
                <input type="text" id="endereco" name="endereco" required class="input">
                <label for="numero" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Número:</label>
                <input type="text" id="numero" name="numero" required class="input">
                <label for="complemento" class="block my-2 text-sm font-medium text-gray-700">Complemento:</label>
                <input type="text" id="complemento" name="complemento" class="input">
                <label for="bairro" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Bairro:</label>
                <input type="text" id="bairro" name="bairro" required class="input">
                <label for="cidade" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Cidade:</label>
                <input type="text" id="cidade" name="cidade" required class="input">
                <label for="uf" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">UF:</label>
                <input type="text" id="uf" name="uf" maxlength="2" required class="input">
            </fieldset>
            
            <!-- Dados de Contato -->
            <fieldset class="p-4 mb-8 bg-white rounded-lg shadow-xl lg:p-8">
                <legend class="px-4 text-lg font-bold text-white rounded-full bg-primary-600">Dados de Contato</legend>
                <label for="nome_contato" class="block mb-1 text-sm font-medium text-gray-700 required">Nome:</label>
                <input type="text" id="nome_contato" name="nome_contato" required class="input">
                <label for="email_cobranca" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">E-mail de Cobrança:</label>
                <input type="email" id="email_cobranca" name="email_cobranca" required class="input">
                <label for="celular_contato" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Celular:</label>
                <input type="tel" id="celular_contato" name="celular_contato" required class="input">
            </fieldset>
            
            <!-- Sócios/Responsáveis -->
            <fieldset class="p-4 mb-8 bg-white rounded-lg shadow-xl lg:p-8">
                <legend class="px-4 text-lg font-bold text-white rounded-full bg-primary-600">Sócios/Responsáveis</legend>
                <div id="sociosContainer">
                    <div id="socio1" class="p-4 border rounded-lg">
                        <h3>Sócio 1</h3>
                        <div class="flex items-center gap-2">
                            <div class="grow">
                                <label for="nome_socio1" class="block mb-1 text-sm font-medium text-gray-700 required">Nome do Sócio:</label>
                                <input type="text" id="nome_socio1" name="nome_socio1" class="input" required>
                                <label for="cpf_socio1" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">CPF do Sócio:</label>
                                <input type="text" id="cpf_socio1" name="cpf_socio1" class="input" maxlength="14" minlength="14" required>
                                <label for="data_nascimento_socio1" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Data de Nascimento:</label>
                                <input type="text" id="data_nascimento_socio1" name="data_nascimento_socio1" class="input data required">
                                <label for="celular_socio1" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Celular do Sócio:</label>
                                <input type="tel" id="celular_socio1" name="celular_socio1" class="input" required>
                                <label for="email_socio1" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">E-mail do Sócio:</label>
                                <input type="email" id="email_socio1" name="email_socio1" class="input" required>
                            </div>
                        </div>
                    </div>
                    <!-- Aqui serão adicionados os campos de sócios dinamicamente -->
                </div>
                <button type="button" onclick="adicionarSocio()" class="my-4 btn-primary">Adicionar Sócio</button>
            </fieldset>

            <!-- Dados da testemunha -->
            <fieldset class="p-4 mb-8 bg-white rounded-lg shadow-xl lg:p-8">
                <legend class="px-4 -mb-2 text-lg font-bold text-white rounded-full bg-primary-600">Dados da testemunha</legend>
                <p class="mb-4 text-sm font-medium text-gray-700">Insira os dados de uma testemunha para a assinatura do contrato</p>
                <label for="nome_testemunha" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Nome:</label>
                <input type="text" id="nome_testemunha" name="nome_testemunha" required class="input">
                <label for="cpf_testemunha" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">CPF:</label>
                <input type="text" id="cpf_testemunha" name="cpf_testemunha" required class="input">
                <label for="data_nascimento_testemunha" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Data de nascimento:</label>
                <input type="text" id="data_nascimento_testemunha" name="data_nascimento_testemunha" required class="input">
                <label for="email_testemunha" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">E-mail:</label>
                <input type="email" id="email_testemunha" name="email_testemunha" required class="input">
            </fieldset>

            <!-- Planos -->
            <fieldset class="p-4 mb-8 bg-white rounded-lg shadow-xl lg:p-8">
                <legend class="px-4 text-lg font-bold text-white rounded-full bg-primary-600">Planos</legend>
                <div class="mb-3 required">Qual vai ser o ramo trabalhado?</div>
                <div class="flex flex-row space-x-4" id="ramo_error">
                    <div class="flex flex-row items-center space-x-2">
                        <input type="checkbox" name="ramo" id="consignado" class="cursor-pointer relative w-6 h-6 aspect-square !appearance-none !bg-none checked:bg-primary-600 bg-white border border-gray-300 shadow-sm rounded !outline-none !ring-0 !text-transparent !ring-offset-0 checked:!border-primary-600 hover:!border-primary-600 cursor-pointer focus-visible:!outline-offset-2 focus-visible:!outline-2 focus-visible:!outline-primary-400/30 focus-visible:border-primary-400 after:w-[35%] after:h-[53%] after:absolute after:opacity-0 after:top-[40%] after:left-[50%] after:-translate-x-2/4 after:-translate-y-2/4 after:rotate-[25deg] after:drop-shadow-[1px_0.5px_1px_rgba(56,149,248,0.5)] after:border-r-[0.17em] after:border-r-white after:border-b-[0.17em] after:border-b-white checked:after:opacity-100 checked:after:rotate-45">
                        <label for="consignado" class="cursor-pointer">Consignado</label>
                    </div>
                    <div class="flex flex-row items-center space-x-2">
                        <input type="checkbox" name="ramo" id="plano_saude" class="cursor-pointer relative w-6 h-6 aspect-square !appearance-none !bg-none checked:bg-primary-600 bg-white border border-gray-300 shadow-sm rounded !outline-none !ring-0 !text-transparent !ring-offset-0 checked:!border-primary-600 hover:!border-primary-600 cursor-pointer focus-visible:!outline-offset-2 focus-visible:!outline-2 focus-visible:!outline-primary-400/30 focus-visible:border-primary-400 after:w-[35%] after:h-[53%] after:absolute after:opacity-0 after:top-[40%] after:left-[50%] after:-translate-x-2/4 after:-translate-y-2/4 after:rotate-[25deg] after:drop-shadow-[1px_0.5px_1px_rgba(56,149,248,0.5)] after:border-r-[0.17em] after:border-r-white after:border-b-[0.17em] after:border-b-white checked:after:opacity-100 checked:after:rotate-45">
                        <label for="plano_saude" class="cursor-pointer">Plano de saúde</label>
                    </div>
                </div>
                <div class="mt-8 mb-2 required">Escolha o plano desejado:</div>
                <div class="grid xl:grid-cols-2 xl:gap-2" id="plano_error">
                    <div>
                        <input class="hidden" id="3_usuarios" type="radio" name="plano" value="3_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl" for="3_usuarios">
                            <span class="text-xs font-semibold uppercase">3 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$300,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>3GB de Armazenamento<sup>1</sup></li>
                                <li>1 relatório customizado<sup>2</sup></li>
                                <li>1 indicador customizado<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="5_usuarios" type="radio" name="plano" value="5_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl peer-checked:text-primary-600" for="5_usuarios">
                            <span class="text-xs font-semibold uppercase">5 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$475,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>3GB de Armazenamento<sup>1</sup></li>
                                <li>2 relatórios customizados<sup>2</sup></li>
                                <li>2 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="10_usuarios" type="radio" name="plano" value="10_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl" for="10_usuarios">
                            <span class="text-xs font-semibold uppercase">10 Usuários</span>
                            <span class="mt-2 text-xl font-bold">R$900,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>3GB de Armazenamento<sup>1</sup></li>
                                <li>3 relatórios customizados<sup>2</sup></li>
                                <li>3 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="15_usuarios" type="radio" name="plano" value="15_usuarios" >
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl" for="15_usuarios">
                            <span class="text-xs font-semibold uppercase">15 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$1.275,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>3GB de Armazenamento<sup>1</sup></li>
                                <li>4 relatórios customizados<sup>2</sup></li>
                                <li>4 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="20_usuarios" type="radio" name="plano" value="20_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl" for="20_usuarios">
                            <span class="text-xs font-semibold uppercase">20 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$1.600,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>5GB de Armazenamento<sup>1</sup></li>
                                <li>5 relatórios customizados<sup>2</sup></li>
                                <li>5 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="30_usuarios" type="radio" name="plano" value="30_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="30_usuarios">
                            <span class="text-xs font-semibold uppercase">30 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$2.250,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>5GB de Armazenamento<sup>1</sup></li>
                                <li>6 relatórios customizados<sup>2</sup></li>
                                <li>6 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="40_usuarios" type="radio" name="plano" value="40_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="40_usuarios">
                            <span class="text-xs font-semibold uppercase">40 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$2.800,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>5GB de Armazenamento<sup>1</sup></li>
                                <li>7 relatórios customizados<sup>2</sup></li>
                                <li>7 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="50_usuarios" type="radio" name="plano" value="50_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="50_usuarios">
                            <span class="text-xs font-semibold uppercase">50 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$3.250,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>5GB de Armazenamento<sup>1</sup></li>
                                <li>10 relatórios customizados<sup>2</sup></li>
                                <li>10 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="75_usuarios" type="radio" name="plano" value="75_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="75_usuarios">
                            <span class="text-xs font-semibold uppercase">75 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$4.500,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>5GB de Armazenamento<sup>1</sup></li>
                                <li>15 relatórios customizados<sup>2</sup></li>
                                <li>15 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="100_usuarios" type="radio" name="plano" value="100_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="100_usuarios">
                            <span class="text-xs font-semibold uppercase">100 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$5.500,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>10GB de Armazenamento<sup>1</sup></li>
                                <li>20 relatórios customizados<sup>2</sup></li>
                                <li>20 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="150_usuarios" type="radio" name="plano" value="150_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="150_usuarios">
                            <span class="text-xs font-semibold uppercase">150 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$7.500,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>15GB de Armazenamento<sup>1</sup></li>
                                <li>30 relatórios customizados<sup>2</sup></li>
                                <li>30 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="200_usuarios" type="radio" name="plano" value="200_usuarios">
                        <label class="flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="200_usuarios">
                            <span class="text-xs font-semibold uppercase">200 usuários</span>
                            <span class="mt-2 text-xl font-bold">R$ 9.000,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>20GB de Armazenamento<sup>1</sup></li>
                                <li>50 relatórios customizados<sup>2</sup></li>
                                <li>50 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                    <div>
                        <input class="hidden" id="300_usuarios" type="radio" name="plano" value="300_usuarios">
                        <label class="box-border flex flex-col p-4 mb-3 border border-gray-300 cursor-pointer rounded-xl checked:border-3" for="300_usuarios">
                            <span class="text-xs font-semibold uppercase">300 usuários ou mais<sup>4</sup></span>
                            <span class="mt-2 text-xl font-bold">R$12.000,00/mês</span>
                            <ul class="mt-2 text-sm">
                                <li>30GB de Armazenamento<sup>1</sup></li>
                                <li>70 relatórios customizados<sup>2</sup></li>
                                <li>70 indicadores customizados<sup>3</sup></li>
                            </ul>
                        </label>
                    </div>
                </div>
                <div class="mt-4 text-xs">
                    <div class="mb-1">1 - Adicional: 5GB -R$20,00</div>
                    <div class="mb-1">2 - Excedente: a partir de R$50,00 por relatório</div>
                    <div class="mb-1">3 - Excedente: a partir de R$50,00 por indicador</div>
                    <div class="mb-1">4 - Excedente: R$300,00 pacote de 10 usuários</div>
                </div>
            </fieldset>

            <button type="submit" id="btnCadastrar" class="sticky inline-flex items-center justify-center w-full my-4 text-center text-white rounded-lg bottom-4 btn bg-primary-700 focus:ring-4 focus:ring-primary-300">
                <span>Cadastrar</span>
                <div class="hidden">
                    <svg class="w-5 h-5 mr-3 -ml-1 text-white animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Enviando...
                </div>
            </button>
        </form>
        <!-- <button onClick="teste()" class="fixed btn top-4">teste</button> -->
    </div>
    
    
    <script>
        function teste () {}
        
        let maskCpfCnpjBehavior = function (val) {
            return val.replace(/\D/g, '').length <= 11 ? '000.000.000-009' : '00.000.000/0000-00'
        },
        maskTelBehavior = function (val) {
            return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009'
        },
        optionsCpfCnpj = {onKeyPress: function(val, e, field, options) {
                field.mask(maskCpfCnpjBehavior.apply({}, arguments), options)
            }
        },
        optionsTel = {onKeyPress: function(val, e, field, options) {
                field.mask(maskTelBehavior.apply({}, arguments), options)
            }
        }
        //adicionar mascara CNPJ/CPF
        $("#cnpj_cpf").mask(maskCpfCnpjBehavior, optionsCpfCnpj)
        $('#cpf_socio1').mask('000.000.000-00')
        $('#cpf_testemunha').mask('000.000.000-00')

        //adicionar mascara de telefone
        $("#celular_contato").mask(maskTelBehavior, optionsTel)
        $("#celular_socio1").mask(maskTelBehavior, optionsTel)
        
        //adicionar mascara de data de nascimento
        $('#data_nascimento_socio1').mask('00/00/0000')
        $('#data_nascimento_testemunha').mask('00/00/0000')

        //adicionar mascara do CEP
        $('#cep').mask('00000-000')

        // Função para buscar endereço pelo CEP
        function buscarEndereco() {
            const cep = $('#cep').val().replace(/\D/g, '') // Limpar caracteres não numéricos
            if (cep.length !== 8) {
                alert('CEP inválido. Informe um CEP com 8 dígitos.')
                return
            }

            $.getJSON(`https://viacep.com.br/ws/${cep}/json/`, function(data) {
                if (data.erro) {
                    alert('CEP não encontrado.')
                } else {
                    $('#endereco').val(data.logradouro)
                    $('#bairro').val(data.bairro)
                    $('#cidade').val(data.localidade)
                    $('#uf').val(data.uf)
                    $('#numero').focus() // Colocar foco no campo número após preencher o endereço
                }
            });
        }

        // Função para adicionar campos de sócios
        let numSocios = 1
        function adicionarSocio() {
            numSocios++
            const novoSocio = `
                <div id="socio${numSocios}" class="p-4 mt-4 border rounded-lg">
                    <h3>Sócio ${numSocios}</h3>
                    <div class="flex items-center gap-2 mt-4">
                        <div class="grow">
                            <label for="nome_socio${numSocios}" class="block mb-1 text-sm font-medium text-gray-700 required">Nome do Sócio:</label>
                            <input type="text" id="nome_socio${numSocios}" name="nome_socio${numSocios}" class="input" required>
                            <label for="cpf_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">CPF do Sócio:</label>
                            <input type="text" id="cpf_socio${numSocios}" name="cpf_socio${numSocios}" class="input" maxlength="14" required>
                            <label for="data_nascimento_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Data de Nascimento:</label>
                            <input type="text" id="data_nascimento_socio${numSocios}" name="data_nascimento_socio${numSocios}" class="input data required">
                            <label for="celular_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">Celular do Sócio:</label>
                            <input type="tel" id="celular_socio${numSocios}" name="celular_socio${numSocios}" class="input" required>
                            <label for="email_socio${numSocios}" class="block mt-2 mb-1 text-sm font-medium text-gray-700 required">E-mail do Sócio:</label>
                            <input type="email" id="email_socio${numSocios}" name="email_socio${numSocios}" class="input" required>
                        </div>
                        <button type="button" onclick="removerSocio(${numSocios})" class="p-4 bg-red-500 rounded-full has-tooltip">
                            <span class='p-1 -mt-8 text-red-500 bg-gray-100 rounded shadow-lg tooltip'>Remover sócio</span>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 stroke-white">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" />
                            </svg>
                        </button>
                    </div>
                </div>
            `
            $('#sociosContainer').append(novoSocio)

            // Aplicar máscaras nos campos do novo sócio
            $(`#cpf_socio${numSocios}`).mask('000.000.000-00')
            $(`#data_nascimento_socio${numSocios}`).mask('00/00/0000')
            $(`#celular_socio${numSocios}`).mask(maskTelBehavior, optionsTel)

            //adicionando validação nos campos do novo sócio
            $(`#cpf_socio${numSocios}`).rules('add', {minlength: 14, messages: {minlength: 'Digite um CPF válido'}})
            $(`#data_nascimento_socio${numSocios}`).rules('add', {minlength: 10, messages: {minlength: 'Digite uma data de nascimento válida'}})
            $(`#celular_socio${numSocios}`).rules('add', {minlength: 14, messages: {minlength: 'Digite um número válido'}})
        }

        // Função para remover campos de sócios
        function removerSocio(num) {
            numSocios--
            $(`#socio${num}`).remove()
        }

        $('form').on('submit', event => {
            event.preventDefault()
            if ($('form').valid()) {
                toggleButtonEnviar()
                const data = Object.fromEntries(new FormData(event.target).entries())
                data.ramos = [
                    $('#plano_saude').is(':checked') ? 'Plano de Saúde' : null,
                    $('#consignado').is(':checked') ? 'Consignado' : null
                ].filter(item => item != null).toString()
                let arraySocios = []
                for (let i = 1; i <= numSocios; i++) {
                    arraySocios.push({
                        nome_socio: data[`nome_socio${i}`],
                        cpf_socio: data[`cpf_socio${i}`],
                        data_nascimento_socio: data[`data_nascimento_socio${i}`],
                        celular_socio: data[`celular_socio${i}`],
                        email_socio: data[`email_socio${i}`],
                    })
                    delete data[`nome_socio${i}`]
                    delete data[`cpf_socio${i}`]
                    delete data[`data_nascimento_socio${i}`]
                    delete data[`celular_socio${i}`]
                    delete data[`email_socio${i}`]
                }
                data.socios = arraySocios
                axios({
                    method: 'POST',
                    url: `https://agiluscrm.com.br:40000/api/ConfirmacaoCadastro/IncluirFichaCadastro`,
                    // url: `http://localhost:55461/api/ConfirmacaoCadastro/IncluirFichaCadastro`,
                    data: data
                }).then(() => {
                    console.log('cliente enviado com sucesso')
                    toggleButtonEnviar()
                    alert('Dados enviados com sucesso.')
                }).catch(error => {
                    alert('Erro ao enviar os dados do formulário, tente novamente.')
                    console.error('cliente não enviado para o Agilus CRM. Erro: ', error)
                    toggleButtonEnviar()
                })
            }
            else {
                alert('Preencha os campos corretamente e tente novamente.')
            }
        })
        
        $.validator.messages.required = 'Campo obrigatório'
        $.validator.messages.email = 'Digite um email válido'
        $.validator.messages.minlength = 'Insira pelo menos {0} dígitos'

        $.validator.addMethod('validacpfcnpj', value => {
            return (value.length === 14 && validaCPF(value)) || (value.length === 18 && validaCNPJ(value))
        }, 'Digite um CPF ou CNPJ válido')
        $.validator.addMethod('validacpf', value => {
            return validaCPF(value)
        }, 'Digite um CPF válido')
        $.validator.addMethod('emailnotequal', (value, element) => {
            let notEqual = true
            $('input[id^="email_socio"]').each((index, input) => {
                if (input.id !== element.id && $(input).val() === value) {
                    notEqual = false
                }
            })
            return notEqual
        }, 'o e-mail não pode ser igual ao utilizado pelos sócios, digite um diferente')
        
        $('#cadastroForm').validate({
            ignore: [],
            debug: true,
            errorClass: 'error text-red-500 text-sm',
            rules: {
                cnpj_cpf: {
                    required: true,
                    validacpfcnpj: true
                },
                cep: {
                    minlength: 9
                },
                celular_contato: {
                    minlength: 14
                },
                cpf_socio1: {
                    validacpf: true
                },
                data_nascimento_socio1: {
                    minlength: 10
                },
                celular_socio1: {
                    minlength: 14
                },
                cpf_testemunha: {
                    validacpf: true
                },
                email_testemunha: {
                    emailnotequal: true
                },
                data_nascimento_testemunha: {
                    minlength: 10
                },
                celular_testemunha: {
                    minlength: 14
                },
                ramo: {
                    required: true
                },
                plano: {
                    required: true
                }
            },
            messages: {
                cnpj_cpf: {
                    minlength: 'Digite pelo menos 11 dígitos'
                },
                ramo: {
                    required: 'Selecione pelo menos 1 opção'
                },
                plano: {
                    required: 'Selecione um plano:'
                },
                cep: {
                    minlength: 'Digite pelo menos 8 dígitos'
                },
                celular_contato: {
                    minlength: 'Digite um número válido'
                },
                data_nascimento_socio1: {
                    minlength: 'Digite uma data de nascimento válida'
                },
                celular_socio1: {
                    minlength: 'Digite um número válido'
                },
                data_nascimento_testemunha: {
                    minlength: 'Digite uma data de nascimento válida'
                },
                celular_testemunha: {
                    minlength: 'Digite um número válido'
                },
            },
            errorPlacement: function(error, element) {
                if (element.attr('name') === 'ramo') {
                    error.insertAfter('#ramo_error')
                }
                else if (element.is(':radio')) {
                    error.insertBefore('#plano_error')
                }
                else {
                    error.insertAfter(element)
                }
            }
        })

        function toggleButtonEnviar () {
            let btnCadastrar = document.getElementById('btnCadastrar')
            const textoEl = btnCadastrar.children[0]
            const loadingEl = btnCadastrar.children[1]
            textoEl.classList.toggle('hidden')
            loadingEl.classList.toggle('flex')
            loadingEl.classList.toggle('hidden')
            if (!loadingEl.classList.contains('hidden')) {
                btnCadastrar.setAttribute('disabled', 'disabled')
            }
            else {
                btnCadastrar.removeAttribute('disabled')
            }
        }

        function validaCPF (cpf) {  
            cpf = cpf.replace(/[^\d]+/g,'')    
            if(cpf == '') return false   
            if (
                cpf.length != 11 || 
                cpf == '00000000000' || 
                cpf == '11111111111' || 
                cpf == '22222222222' || 
                cpf == '33333333333' || 
                cpf == '44444444444' || 
                cpf == '55555555555' || 
                cpf == '66666666666' || 
                cpf == '77777777777' || 
                cpf == '88888888888' || 
                cpf == '99999999999' || 
                cpf == '01234567890' )
                return false      
            add = 0    
            for (i=0; i < 9; i++)       
                add += parseInt(cpf.charAt(i)) * (10 - i)
            rev = 11 - (add % 11)
            if (rev == 10 || rev == 11)     
                rev = 0  
            if (rev != parseInt(cpf.charAt(9)))     
                return false    
            add = 0    
            for (i = 0; i < 10; i ++)        
                add += parseInt(cpf.charAt(i)) * (11 - i)
            rev = 11 - (add % 11)
            if (rev == 10 || rev == 11) 
                rev = 0  
            if (rev != parseInt(cpf.charAt(10)))
                return false     
            return true 
        }

        function validaCNPJ(CNPJ) {
            CNPJ = CNPJ.replace(/[^\d]+/g,'') 
            var a = new Array()
            var b = new Number
            var c = [6,5,4,3,2,9,8,7,6,5,4,3,2]
            for (i=0; i<12; i++){
                a[i] = CNPJ.charAt(i)
                b += a[i] * c[i+1]
            }
            if ((x = b % 11) < 2) { a[12] = 0 } else { a[12] = 11-x }
            b = 0;
            for (y=0; y<13; y++) {
                b += (a[y] * c[y]);
            }
            if ((x = b % 11) < 2) { a[13] = 0; } else { a[13] = 11-x; }
            if ((CNPJ.charAt(12) != a[12]) || (CNPJ.charAt(13) != a[13])){
                return false;
            }
            if (CNPJ == '00000000000000') {
                return false;
            }
            return true;
        }
    </script>
</body>
</html>
